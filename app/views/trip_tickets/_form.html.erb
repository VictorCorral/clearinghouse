<%= form_for(@trip_ticket) do |f| %>
  <% if @trip_ticket.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@trip_ticket.errors.count, "error") %> prohibited this trip_ticket from being saved:</h2>

      <ul>
      <% @trip_ticket.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <fieldset id="originator" class="">
    <legend>Originator</legend>
    
    <div class="field">
      <%= f.label :origin_provider_id, "Provider" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.collection_select :origin_provider_id, Provider.all, :id, :name, :include_blank => true %>
      <% else %>
        <%= @trip_ticket.origin_provider_id %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :origin_customer_id, "Customer ID" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :origin_customer_id, :readonly => true %>
      <% else %>
        <%= @trip_ticket.origin_customer_id %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :origin_trip_id, "Trip ID" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :origin_trip_id, :readonly => true %>
      <% else %>
        <%= @trip_ticket.origin_trip_id %>
      <% end %>
    </div>
  </fieldset>

  <fieldset id="claimant" class="">
    <legend>Claimant</legend>
    
    <div class="field">
      <%= f.label :claimant_provider_id, "Provider" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.collection_select :claimant_provider_id, Provider.all, :id, :name, :include_blank => true %>
      <% else %>
        <%= @trip_ticket.claimant_provider_id %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :claimant_customer_id, "Customer ID" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :claimant_customer_id, :readonly => true %>
      <% else %>
        <%= @trip_ticket.claimant_customer_id %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :claimant_trip_id, "Trip ID" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :claimant_trip_id, :readonly => true %>
      <% else %>
        <%= @trip_ticket.claimant_trip_id %>
      <% end %>
    </div>    
    <div class="field">
      <%= f.label :approved_claim_id %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :approved_claim_id, :readonly => true %>
      <% else %>
        <%= @trip_ticket.approved_claim_id %>
      <% end %>
    </div>
  </fieldset>
  
  <fieldset id="customer" class="">
    <legend>Customer</legend>
    <div class="field">
      <%= f.label :customer_first_name, "First Name" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :customer_first_name %>
      <% else %>
        <%= @trip_ticket.customer_first_name %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_middle_name, "Middle Name" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :customer_middle_name %>
      <% else %>
        <%= @trip_ticket.customer_middle_name %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_last_name, "Last Name" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :customer_last_name %>
      <% else %>
        <%= @trip_ticket.customer_last_name %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_dob, "Date of Birth" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.date_select(:customer_dob, 
                          :order => [:month, :day, :year],
                          :prompt => { :day => 'Select day', :month => 'Select month', :year => 'Select year' },
                          :start_year => Time.now.year - 100,
                          :end_year => Time.now.year
        ) %>
      <% else %>
        <%= @trip_ticket.customer_dob %>
      <% end %>
    </div>
    <% if can? :edit, @trip_ticket %>
      <%= f.fields_for :customer_address do |af| %>
        <%= render 'locations/address_form', :f => af %>
      <% end %>    
    <% else %>
      <%= render 'locations/show_fields', :location => @trip_ticket.customer_address %>
    <% end %>
    <div class="field">
      <%= f.label :customer_primary_phone, "Primary Phone Number" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.phone_field :customer_primary_phone %>
      <% else %>
        <%= @trip_ticket.customer_primary_phone %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_emergency_phone, "Emergency Phone Number" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.phone_field :customer_emergency_phone %>
      <% else %>
        <%= @trip_ticket.customer_emergency_phone %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_primary_language, "Primary Language" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :customer_primary_language %>
      <% else %>
        <%= @trip_ticket.customer_primary_language %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_ethnicity_id, "Ethnicity" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.collection_select :customer_ethnicity_id, Ethnicity.all, :id, :name, :include_blank => true %>
      <% else %>
        <%= @trip_ticket.customer_ethnicity_id %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_impairment_description, "Impairment Description" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :customer_impairment_description %>
      <% else %>
        <%= @trip_ticket.customer_impairment_description %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_information_withheld, "Information Withheld?" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.select :customer_information_withheld, [["Yes", true], ["No", false]], :include_blank => true %>
      <% else %>
        <%= @trip_ticket.customer_information_withheld %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_notes %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_area :customer_notes %>
      <% else %>
        <%= @trip_ticket.customer_notes %>
      <% end %>
    </div>
  </fieldset>  

  <fieldset id="drop_off_location" class="">
    <legend>Drop Off Location</legend>
    <% if can? :edit, @trip_ticket %>
      <%= f.fields_for :drop_off_location do |af| %>
        <%= render 'locations/address_form', :f => af %>
      <% end %>    
    <% else %>
      <%= render 'locations/show_fields', :location => @trip_ticket.drop_off_location %>
    <% end %>
  </fieldset>  

  <fieldset id="pick_up_location" class="">
    <legend>Pick Up Location</legend>
    <% if can? :edit, @trip_ticket %>
      <%= f.fields_for :pick_up_location do |af| %>
        <%= render 'locations/address_form', :f => af %>
      <% end %>    
    <% else %>
      <%= render 'locations/show_fields', :location => @trip_ticket.pick_up_location %>
    <% end %>
  </fieldset>  

  <fieldset id="trip_information" class="">
    <legend>Trip Information</legend>
    
    <div class="field">
      <%= f.label :appointment_time %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.time_select :appointment_time, :ampm => true, :minute_step => 15, :include_blank => true %>
      <% else %>
        <%= @trip_ticket.appointment_time %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :requested_pickup_time %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.time_select :requested_pickup_time, :ampm => true, :minute_step => 15, :include_blank => true %>
      <% else %>
        <%= @trip_ticket.requested_pickup_time %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :requested_drop_off_time %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.time_select :requested_drop_off_time, :ampm => true, :minute_step => 15, :include_blank => true %>
      <% else %>
        <%= @trip_ticket.requested_drop_off_time %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :earliest_pick_up_time %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.time_select :earliest_pick_up_time, :ampm => true, :minute_step => 15, :include_blank => true %>
      <% else %>
        <%= @trip_ticket.earliest_pick_up_time %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :allowed_time_variance %> (in minutes):
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.select :allowed_time_variance, [["Any", -1]] + (1..60).to_a.select{ |i| i % 10 == 0 }, :include_blank => true %>
      <% else %>
        <%= @trip_ticket.allowed_time_variance %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_boarding_time, "Boarding time required" %> (in minutes):
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.number_field :customer_boarding_time, :min => 0, :max => 15 %>
      <% else %>
        <%= @trip_ticket.customer_boarding_time %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_deboarding_time, "Deboarding time required" %> (in minutes):
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.number_field :customer_deboarding_time, :min => 0, :max => 15 %>
      <% else %>
        <%= @trip_ticket.customer_deboarding_time %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :customer_seats_required, "Seats Required" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.number_field :customer_seats_required, :min => 0 %>
      <% else %>
        <%= @trip_ticket.customer_seats_required %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :mobility_type_id %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.collection_select :mobility_type_id, MobilityType.all, :id, :name, :include_blank => true %>
      <% else %>
        <%= @trip_ticket.mobility_type_id %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :num_attendants, "Number of Attendants" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.number_field :num_attendants, :min => 0 %>
      <% else %>
        <%= @trip_ticket.num_attendants %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :num_guests, "Number of Guests" %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.number_field :num_guests, :min => 0 %>
      <% else %>
        <%= @trip_ticket.num_guests %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :scheduling_priority %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.select :scheduling_priority, TripTicket::SCHEDULING_PRIORITY.invert, :include_blank => true %>
      <% else %>
        <%= @trip_ticket.scheduling_priority %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :trip_purpose_code %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :trip_purpose_code %>
      <% else %>
        <%= @trip_ticket.trip_purpose_code %>
      <% end %>
    </div>
    <div class="field">
      <%= f.label :trip_purpose_description %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_field :trip_purpose_description %>
      <% else %>
        <%= @trip_ticket.trip_purpose_description %>
      <% end %>
    </div>    
    <div class="field">
      <%= f.label :trip_notes %>:
      <% if can? :edit, @trip_ticket %>
        <br /><%= f.text_area :trip_notes %>
      <% else %>
        <%= @trip_ticket.trip_notes %>
      <% end %>
    </div>
  </fieldset>

  <fieldset id="info" class="">
    <legend>Info</legend>
    
    <div class="field">
      <%= f.label :created_at %>:
      <%= @trip_ticket.created_at %>
    </div>
    <div class="field">
      <%= f.label :updated_at %>:
      <%= @trip_ticket.updated_at %>
    </div>    
  </fieldset>
  
  <% if can? :edit, @trip_ticket %>
    <div class="actions">
      <%= f.submit %>
    </div>
  <% end %>
<% end %>
